<ui:composition template="/layouts/layoutInterior.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">
	<ui:define name="content">
		<div class="content_newForm">
				<div class="titleFormulario">
					<h3 style="margin-top: 0">Modificați membru</h3>
				</div>

		<div class="container-fluid">
			<h:form id="formModific" class="tabsInvert">
				<p:growl id="msgs" showDetail="true" />
				<p:accordionPanel multiple="true" activeIndex="0,1,2,3">
					<p:tab title="Informații personale / comunicare  membru: #{userBean.usuario.nombreCompleto}">
						<div class="tabAccordion">
							<div class="ui-g">
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="nombre" value="Nume:" /></b>
									<p:inputText id="nombre"
										value="#{userBean.usuario.name}" required="true"
										requiredMessage="Introduce numele" />
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="prenume" value="Prenume:" /></b>
									<p:inputText id="prenume" required="true"
										value="#{userBean.usuario.lastName}"
										requiredMessage="Introduce numele de familie" />
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="nif" value="CNP:" /></b>
									<p:inputText id="nif" value="#{userBean.usuario.idCard}" />
								</div>	
							</div>
							<div class="ui-g">
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="teamSelect" value="Funcție:" /></b>
									<p:selectOneMenu value="#{userBean.usuario.team.id}" 
										id="teamSelect" class="selectFiltro" style="min-width:initial;" >
										<f:selectItem itemLabel="Alege una..." itemValue="" />
										<f:selectItems value="#{userBean.listaFunctii}"
											var="team"
											itemLabel="#{team.name}"
											itemValue="#{team.id}" />
									</p:selectOneMenu>								
								</div>
								
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="username" value="Utilizator:" /></b>
									<p:inputText id="username"
										value="#{userBean.usuario.username}" />
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="rolSelect" value="Rol:" /></b>
									<p:importEnum
										type="ro.per.online.persistence.entities.enums.RoleEnum"
										var="rol" allSuffix="ALL_ENUM_VALUES" />
									<p:selectOneMenu value="#{userBean.usuario.role}"
										id="rolSelect"
										required="true" requiredMessage="Selectați un rol" styleClass="form-control form-select">
										<f:selectItem itemLabel="Alege un rol" itemValue="" />
										<f:selectItems value="#{rol.ALL_ENUM_VALUES}" var="rol"
											itemLabel="#{rol.description}" itemValue="#{rol}" />
									</p:selectOneMenu>							
								</div>
							</div>
							<div class="ui-g">
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="mobilePhone" value="Telefon :" /></b>
									<p:inputText id="mobilePhone"
										value="#{userBean.usuario.phone}" />
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="email" value="Email:" /></b>
									<p:inputText id="email" value="#{userBean.usuario.email}" />
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="address" value="Adresa:" /></b>
									<p:inputText id="address" value="#{userBean.usuario.address}" />
								</div>
							</div>
							<div class="ui-g">												
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="numberCard" value="Numărul documentului de identitate:" /></b>
									<p:inputText id="numberCard" value="#{userBean.usuario.numberCard}" />
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="birthDate" value="Data nașterii:" /></b>
									<p:calendar id="birthDate" pattern="dd/MM/yyyy" locale="ro" navigator="true" 
									maxdate="#{currentDate}" value="#{userBean.usuario.birthDate}" />
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="educationSelect" value="Nivel de educație:" /></b>
									<p:importEnum
										type="ro.per.online.persistence.entities.enums.EducationEnum"
										var="education" allSuffix="ALL_ENUM_VALUES" />
									<p:selectOneMenu value="#{userBean.usuario.education}"
										id="educationSelect"
										required="true" requiredMessage="Selectați un nivel de educație" styleClass="form-control form-select">
										<f:selectItem itemLabel="Alege un nivel de educație" itemValue="" />
										<f:selectItems value="#{education.ALL_ENUM_VALUES}" var="education"
											itemLabel="#{education.description}" itemValue="#{education}" />
									</p:selectOneMenu>									
								</div>
							</div>
							<div class="ui-g">
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="workplace" value="Locul de muncă:" /></b>
									<p:inputText id="workplace" value="#{userBean.usuario.workplace}" />
								</div>	
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="sexSelect" value="Sexul:" /></b>
									<p:importEnum
										type="ro.per.online.persistence.entities.enums.SexEnum"
										var="sex" allSuffix="ALL_ENUM_VALUES" />
									<p:selectOneMenu value="#{userBean.usuario.sex}"
										id="sexSelect"
										required="true" requiredMessage="Selectați tipul sexului" styleClass="form-control form-select">
										<f:selectItem itemLabel="Alegeți tipul sexului" itemValue="" />
										<f:selectItems value="#{sex.ALL_ENUM_VALUES}" var="sex"
											itemLabel="#{sex.description}" itemValue="#{sex}" />
									</p:selectOneMenu>								
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="civilStatusSelect" value="Starea civilă:" /></b>
									<p:importEnum
										type="ro.per.online.persistence.entities.enums.CivilStatusEnum"
										var="civilStatus" allSuffix="ALL_ENUM_VALUES" />
									<p:selectOneMenu value="#{userBean.usuario.civilStatus}"
										id="civilStatusSelect"
										required="true" requiredMessage="Selectați starea civilă" styleClass="form-control form-select">
										<f:selectItem itemLabel="Alegeți starea civila" itemValue="" />
										<f:selectItems value="#{civilStatus.ALL_ENUM_VALUES}" var="civilStatus"
											itemLabel="#{civilStatus.description}" itemValue="#{civilStatus}" />
									</p:selectOneMenu>							
								</div>							
							</div>						
							
							<div class="ui-g">							
								<div class="ui-g-12 ui-md-6 ui-lg-4">
								<b><h:outputLabel for="validated" value="Activ/ Blocat:" /></b>
								<p:selectOneMenu styleClass="form-control form-select" id="validated"
									value="#{userBean.usuario.validated}">
									<f:selectItem itemLabel="ACTIV" itemValue="true" />
									<f:selectItem itemLabel="BLOCAT" itemValue="false" />
								</p:selectOneMenu>
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
								<b><h:outputText for="eliminado" value="Situație membru :  " /></b>
								 <p:selectBooleanButton id="eliminado" value="#{userBean.eliminado}" onLabel="Eliminat" offLabel="Activ" style="width:80px" />
 
								</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
								<b><h:outputLabel for="provinciaSelect" value="Județul/Organizația (*):" /></b>
									<p:selectOneMenu value="#{userBean.provincia.name}"  id="provinciasSelect" styleClass="form-control form-select" filter="true" filterMatchMode="startsWith" >
										<f:selectItem itemLabel="Toate" itemValue="" />
										<f:selectItems value="#{userBean.provinces}" var="province" itemLabel="#{province.name}" itemValue="#{province.name}" />
										 <p:ajax event="change" update="municipiosSelect"
											listener="#{userBean.actualLocalidades(userBean.provincia.name)}" />   
									</p:selectOneMenu> 								
								</div>
							</div>
							<p:separator />
							<div class="ui-g">
								<div class="ui-g-12 ui-md-6 ui-lg-4">								
								<b><h:outputLabel for="municipiosSelect" value="Localitatea/Sector (*):" /></b>
								<p:selectOneMenu value="#{userBean.usuario.locality.name}" id="municipiosSelect" filter="true" 
									filterMatchMode="startsWith" styleClass="form-control form-select" >															
									<f:selectItems value="#{userBean.localidades}" var="municipio" itemLabel="#{municipio.name}" itemValue="#{municipio.name}" />
								</p:selectOneMenu>
								<p:messages for="municipiosSelect" autoUpdate="true"  closable="true"/>
							</div>
								<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="municipiosSelect"  value="Înregistrați o nouă localitate (*):" /></b>
									<p:separator />
									<p:commandButton id="buttMunicipio" title="Adăugați o nouă localitate (trebuie să selectați anterior un județ)" 
										type="button" onclick="PF('dialogMunicipio').show()" icon="fa fa-fw fa fa-plus" update="crearMunicipio" 
										disabled="#{userBean.localidades == null}"/>									
								</div>													
							</div>					
							<p:separator />
							<div class="ui-g">									
								<div class="ui-g-12 ui-md-6 ui-lg-4">								
									<b><h:outputLabel for="imagenG" value="Fotografia :" /></b>
									<p:separator />
									<p:graphicImage rendered="#{not empty userBean.usuario.photo}" id="imagenG" value="#{userBean.usuario.imageUser}" cache="false" stream="false">
									<f:param name="id" value="#{userBean.usuario.id}" />
									 </p:graphicImage>
									</div>	
									<div class="ui-g-12 ui-md-6 ui-lg-4">
									<b><h:outputLabel for="imagenNueva" value=" Încarcă noua fotografie :" /></b>
									<p:separator />
									<p:fileUpload fileUploadListener="#{userBean.cargaImagen}" mode="advanced" dragDropSupport="false"
									   sizeLimit="204800" invalidSizeMessage=" Dimensiunea maximă permisă este de 20MB" required="true" 
									   fileLimit="1" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" 
									   uploadLabel=" Salvează noua fotografie" cancelLabel=" Renunțare" label="Încarcă/Caută fotografia" update="imagenG" /> 
								</div>									
							</div>
							<div class="botonesFormulario">
								<p:commandButton actionListener="#{userBean.restaurarClave}"
									value="Resetați parola" />
								<p:commandButton
									actionListener="#{userBean.modificarUsuario(userBean.usuario,userBean.provincia.name,userBean.usuario.locality.name)}"
									value="Salvare" update ="@form"/>
							</div>
						</div>
					</p:tab>
					</p:accordionPanel>
				<p:dialog id="dialog" widgetVar="dialogMessage" header="INFO"
					closable="true">
					<p:messages for="dialogMessage" autoUpdate="true" showDetail="true"
						showSummary="true" />
						 <div class="centrarBotonesDialog">
                   <p:button value="Închideţi" outcome="/users/users" />
               </div>
				</p:dialog>
			
		<p:dialog id="crearMunicipio" widgetVar="dialogMunicipio" header="Înregistrare oraș/localitate nouă" position="center" resizable="false" onShow="$('[id*=inputNombre]').val('');" modal="true" width="40%" >
			<h:outputLabel for="inputNombre" value=" Numele noii localități (*):" />
			<p:inputText id="inputNombre" binding="#{nombreMunicipio}"
				required="#{param['form:guardar']!=null}" requiredMessage="Numele orașului nu poate fi gol" converter="#{trimConverter}" />
			
			<h:outputLabel for="typeLocality" value="Alegeți tipul localității (*):" />
			<p:importEnum type="ro.per.online.persistence.entities.enums.TypeLocalityEnum"
				var="typeLocalitys" allSuffix="ALL_ENUM_VALUES" />
				<p:selectOneMenu value="#{userBean.tipLocalidadSelected}" id="typeLocality" class="selectFiltro" style="min-width:initial;" 
				effect="fold" required="#{param['form:guardar']!=null}"  requiredMessage="Este obligatoriu să alegeți un tip de localitate">
					<f:selectItem itemLabel="Alege unul..." itemValue="" />
					<f:selectItems value="#{typeLocalitys.ALL_ENUM_VALUES}" var="tipLocalidadSelected" itemLabel="#{tipLocalidadSelected.description}"
				itemValue="#{tipLocalidadSelected}" />
				</p:selectOneMenu>
			<b><h:outputLabel for="provinciaSelect" value="Județul/Organizația:" /></b>
									<p:selectOneMenu value="#{userBean.usuario.province}" 
										id="provinciaSelect" filter="true" filterMatchMode="startsWith"
										 styleClass="form-control form-select" converter="#{selectConverter}">
										<f:selectItem itemLabel="#{userBean.usuario.province}" />
										<f:selectItems value="#{userBean.provinces}"  var="provincia"
											itemLabel="#{provincia.name}" itemValue="#{provincia}" />
									</p:selectOneMenu>		
			
			<div class="centrarBotonesDialog">
				<p:commandButton id="guardar" value="Înregistrează" actionListener="#{userBean.nuevoMunicipio(nombreMunicipio.value, userBean.usuario.province,userBean.tipLocalidadSelected, userBean.usuario)}" 
				update ="@form"  oncomplete="PF('dialogMunicipio').hide()"/>
				<p:commandButton value="Închidere" onclick="PF('dialogMunicipio').hide()"/>
			</div>
		</p:dialog>	
				<div class="botonesFormulario">
			<p:button outcome="/users/users" value="Întoarcere" icon="fa fa-fw fa-undo" />
		</div>			
		</h:form>

		</div>

		</div>

	</ui:define>
</ui:composition>
